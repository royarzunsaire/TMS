@{
    string action = Convert.ToString(ViewContext.RouteData.Values["Action"]);
    string titulo = action.Contains("MyIndex") ? " Mis " : " Todas ";
    titulo = action.Contains("Coordinador") ? " Coordinadores " : " ";
    ViewBag.Title = "Listado" + titulo + "Comercializaciones";
    Layout = "~/Views/Shared/_Layout.cshtml";

    int enProceso = 0;
    int enProcesoSence = 0;
    int terminadas = 0;
    int terminadasSence = 0;
    int DJOPendientes = 0;
    int DJPPendientes = 0;
    int r24Pendientes = 0;
    int emailNoEnviados = 0;

    if (ViewBag.enProceso != null) { enProceso = ViewBag.enProceso; }
    if (ViewBag.enProcesoSence != null) { enProcesoSence = ViewBag.enProcesoSence; }
    if (ViewBag.terminadas != null) { terminadas = ViewBag.terminadas; }
    if (ViewBag.terminadasSence != null) { terminadasSence = ViewBag.terminadasSence; }
    if (ViewBag.DJOPendientes != null) { DJOPendientes = ViewBag.DJOPendientes; }
    if (ViewBag.DJPPendientes != null) { DJPPendientes = ViewBag.DJPPendientes; }
    if (ViewBag.r24Pendientes != null) { r24Pendientes = ViewBag.r24Pendientes; }
    if (ViewBag.emailNoEnviados != null) { emailNoEnviados = ViewBag.emailNoEnviados; }
}


<div hidden>
    @using (Html.BeginForm("IndexData", "Comercializacions", FormMethod.Post, new { @id = ("form-ModalParticipanteCliente") }))
    {
        @Html.AntiForgeryToken()


    }
</div>



@section Styles{
    <style>
        .sence {
            background-color: #add8e6;
            vertical-align: middle;
        }

        .no_sence {
            background-color: #9B59B6;
            vertical-align: middle;
        }

        .arriendo {
            background-color: #DAD7D6;
            vertical-align: middle;
        }

        .btn-group, .btn-group-vertical {
            position: unset;
        }

        .dropdown-menu {
            left: auto;
        }
    </style>
}


<h3 class="page-title">
    Administración @titulo Comercializaciones
</h3>
@if (!action.Contains("Coordinador") && !action.Contains("IndexPostCurso"))
{
    <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", enProceso)">@String.Format("{0}", enProceso)</span>
                        </h3>
                        <small> En proceso</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @enProceso cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @enProceso </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", enProcesoSence)">@String.Format("{0}", enProcesoSence)</span>
                        </h3>
                        <small> En Proceso SENCE</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @enProcesoSence cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @enProcesoSence </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", terminadas)">@String.Format("{0}", terminadas)</span>
                        </h3>
                        <small> Teminadas</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @terminadas cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @terminadas </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", terminadasSence)">@String.Format("{0}", terminadasSence)</span>
                        </h3>
                        <small>Terminadas SENCE</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @terminadasSence cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @terminadasSence </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@if (action.Contains("IndexPostCurso"))
{
    <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", DJOPendientes)">@String.Format("{0}", DJOPendientes)</span>
                        </h3>
                        <small>DJO Pendientes</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @DJOPendientes cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @DJOPendientes </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", DJPPendientes)">@String.Format("{0}", DJPPendientes)</span>
                        </h3>
                        <small> DJP Pendientes</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @DJPPendientes cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @DJPPendientes </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", r24Pendientes)">@String.Format("{0}", r24Pendientes)</span>
                        </h3>
                        <small>R24 Pendientes</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @r24Pendientes cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @r24Pendientes </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
            <div class="dashboard-stat2 " style="padding-top:31px">
                <div class="display">
                    <div class="number">
                        <h3 class="font-green-sharp">
                            <small class="font-green-sharp"></small>
                            <span data-counter="counterup" data-value="@String.Format("{0}", emailNoEnviados)">@String.Format("{0}", emailNoEnviados)</span>
                        </h3>
                        <small>Emails No Enviados</small>
                    </div>
                </div>
                <div class="progress-info">
                    <div class="progress">
                        <span style="width: 100%;" class="progress-bar progress-bar-success green-sharp">
                            <span class="sr-only"> @emailNoEnviados cantidad</span>
                        </span>
                    </div>
                    <div class="status">
                        <div class="status-title"> Comercializaciones </div>
                        <div class="status-number">  @emailNoEnviados </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

@if (action.Contains("PostCurso"))
{
    <div class="col-md-12 col-md-offset-2">
        @Html.Label(" Declaración Jurada OTEC", htmlAttributes: new { @class = "btn btn-secondary  glyphicon glyphicon-pencil", @datatoggle = "tooltip", @title = "Declaración Jurada OTEC" })
        @Html.Label(" Credenciales Listas", htmlAttributes: new { @class = "btn btn-secondary  glyphicon glyphicon-credit-card", @datatoggle = "tooltip", @title = "Credenciales Listas" })
        @Html.Label(" Información Revisada", htmlAttributes: new { @class = "btn btn-secondary  glyphicon glyphicon-check", @datatoggle = "tooltip", @title = "Información Revisada" })
        @Html.Label(" Correo a cliente enviado", htmlAttributes: new { @class = "btn btn-secondary  glyphicon glyphicon-envelope", @datatoggle = "tooltip", @title = "Correo a cliente enviado" })
    </div>
}

<div class="row">
    <div class="col-md-12">
        <div class="portlet box blue-dark">
            <div class="portlet-title">
                <div class="caption">
                    Comercializaciones
                </div>
                <div class="tools">
                    <a href="javascript:;" class="collapse"> </a>
                    <a href="javascript:;" class="fullscreen"> </a>
                </div>
                <!--
                <div class="actions">
                    <button type="button" class="btn btn-default" id="btnCerrarNode" style="margin-right:15px">Arreglar Generador de Documentos</button>
                </div> -->
            </div>
            <div class="portlet-body">
                @if (!action.Contains("Coordinador"))
                {
                    <div class="caption margin-bottom-10">Filtros</div>
                    <div class="row">
                        <div class="col-sm-3">
                            <label for="te"> Tipo Ejecución: </label>
                            <select id="te" class="filter">
                                <option value="">Seleccione una opción</option>
                                <option value="Presencial">Presencial</option>
                                <option value="Recertificacion">Recertificación</option>
                                <option value="Recertificacion_Asincronica">Recertificación Asincronica</option>
                                <option value="Recertificacion_Sincronica">Recertificación Sincronica</option>
                                <option value="Elearning_Asincrono">Elearning Asincrono</option>
                                <option value="Elearning_Sincrono">Elearning Sincrono</option>
                            </select>
                        </div>
                        <div class="col-sm-3">
                            <label for="es">Estado: </label>
                            <select id="es" class="filter">
                                <option value="">Seleccione una opción</option>
                                <option value="En Proceso">En Proceso</option>
                                <option value="En Proceso SENCE">En Proceso SENCE</option>
                                <option value="Teminadas">Teminadas</option>
                                <option value="Terminadas SENCE">Terminadas SENCE</option>
                            </select>
                        </div>
                    </div>
                }
            <div style="margin: 10px 0 10px 0;">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            </div>
                <table class="table table-striped table-bordered table-hover dt-responsive dataTable" id="sys-table-comercializacion" cellspacing="0">
                    <thead>
                        <tr>
                            <th style="min-width:60px">Código</th>
                            <th>Curso</th>
                            <th>Cliente</th>
                            @if (action.Contains("PostCurso"))
                            {
                                <th>Fecha</th>
                            }
                            else
                            {
                                <th>Fecha Inicio</th>
                                <th>Fecha Termino</th>
                            }
                            <th>Tipo Ejecución</th>
                            <th>Estado</th>
                            <th>Comercial</th>
                            @if (action.Contains("PostCurso"))
                            {
                                <th>Post-Curso</th>
                                <th>Encuesta</th>
                            }
                            <th></th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>
@*//Modals*@
@section topLevel{
    @{Html.RenderPartial("_RenderConfirm.Modal"); }
}

<div id="modal-cancelar" class="modal fade draggable-modal modalx" tabindex="-1" data-backdrop="static" data-keyboard="false" role="alertdialog" aria-hidden="true">
    <div class="modal-dialog">
        <div id="modal-content" class="modal-content">
            @using (Html.BeginForm("Cancelado", "Comercializacions"))
            {
                @Html.AntiForgeryToken()
                <div class="modal-header">
                    <div class="row">
                        <div class="col-md-10">
                            <h4 class="modal-title">Confirmar Cambio de Estado</h4>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-body text-center">
                    @*@Html.ValidationSummary(true, "", new { @class = "text-danger" })*@
                    <input type="hidden" id="idComercializacionCancelar" name="idComercializacion" value="" />
                    ¿Está seguro que desea continuar?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Volver</button>
                    <input type="submit" value="Cancelar Comercialización" class="btn btn-danger" />
                </div>
            }
        </div>
    </div>
</div>

<div id="modal-terminar-sence" class="modal fade draggable-modal modalx" tabindex="-1" data-backdrop="static" data-keyboard="false" role="alertdialog" aria-hidden="true">
    <div class="modal-dialog">
        <div id="modal-content" class="modal-content">
            @using (Html.BeginForm("TerminadoSence", "Comercializacions"))
            {
                @Html.AntiForgeryToken()
                <div class="modal-header">
                    <div class="row">
                        <div class="col-md-10">
                            <h4 class="modal-title">Confirmar Cambio de Estado</h4>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-body text-center">
                    @*@Html.ValidationSummary(true, "", new { @class = "text-danger" })*@
                    <input type="hidden" id="idComercializacionTerminarSence" name="idComercializacion" value="" />
                    ¿Está seguro que desea continuar?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Volver</button>
                    <input type="submit" value="Terminar SENCE" class="btn btn-danger" />
                </div>
            }
        </div>
    </div>
</div>

<div id="modal-terminar" class="modal fade draggable-modal modalx" tabindex="-1" data-backdrop="static" data-keyboard="false" role="alertdialog" aria-hidden="true">
    <div class="modal-dialog">
        <div id="modal-content" class="modal-content">
            @using (Html.BeginForm("Terminado", "Comercializacions"))
            {
                @Html.AntiForgeryToken()
                <div class="modal-header">
                    <div class="row">
                        <div class="col-md-10">
                            <h4 class="modal-title">Confirmar Cambio de Estado</h4>
                        </div>
                        <div class="col-md-2">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-body text-center">
                    @*@Html.ValidationSummary(true, "", new { @class = "text-danger" })*@
                    <input type="hidden" id="idComercializacionTerminar" name="idComercializacion" value="" />
                    ¿Está seguro que desea continuar?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Volver</button>
                    <input type="submit" value="Terminar" class="btn btn-danger" />
                </div>
            }
        </div>
    </div>
</div>

<div class="modal fade draggable-modal modalx"
     id="modalDiploma"
     tabindex="-1"
     data-backdrop="static"
     data-keyboard="false"
     role="dialog"
     aria-labelledby="deleteLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">
                    <div class="col-md-10">
                        <h4 class="modal-title">Seleccionar Relator para Generar Diplomas</h4>
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <button type="button" class="btn btn-default pull-right" id="btnUnR23">Generar por Participante</button>
                        <button type="button" class="btn btn-default pull-right" id="btnTodosR23" style="display:none">Generar Todos</button>
                    </div>
                </div>
                <div class="row" id="todosR23">
                    <div class="col-md-12">
                        @using (Html.BeginForm("GenerarPdfR23", "Comercializacions", FormMethod.Post, new { @id = "form" }))
                        {
                            @Html.AntiForgeryToken()

                            <input type="hidden" name="id" id="idComercializacionR23" />
                            <div class="form-group">
                                <label class="control-label">Aprobación</label>
                                <select class="form-control" name="id3">
                                    <option value="aprobados" selected>Aprobados</option>
                                    <option value="reprobados">Reprobados</option>
                                </select>
                            </div>
                            <div class="form-group">
                                @Html.Label("idRelator", "Relator", htmlAttributes: new { @class = "control-label" })
                                <select name="id2" id="relatores" class="form-control"></select>
                            </div>
                        }
                    </div>
                </div>
                <div class="row" id="unR23" hidden>
                    <div class="col-md-12">
                        @using (Html.BeginForm("GenerarPdfR23Uno", "Comercializacions", FormMethod.Post, new { @id = "formUno" }))
                        {
                            @Html.AntiForgeryToken()

                            <div class="form-group">
                                @Html.Label("idRelator", "Relator", htmlAttributes: new { @class = "control-label" })
                                <select name="id2" id="relatoresUno" class="form-control"></select>
                            </div>
                            <div class="form-group">
                                @Html.Label("idParticipante", "Participante", htmlAttributes: new { @class = "control-label" })
                                <select name="id" id="participantesR23" class="form-control"></select>
                            </div>
                        }
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6 text-left">
                        <button type="button" id="btnCerrar" class="btn btn-default" data-dissmiss="modal">Cancelar</button>
                    </div>
                    <div class="col-md-6">
                        <button type="submit" id="btnEnviar" class="btn btn-primary">Generar Diplomas</button>
                        <button type="submit" id="btnEnviarUno" class="btn btn-primary" style="display:none">Generar Diploma</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade draggable-modal modalx"
     id="modalR17"
     tabindex="-1"
     data-backdrop="static"
     data-keyboard="false"
     role="dialog"
     aria-labelledby="deleteLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">
                    <div class="col-md-10">
                        <h4 class="modal-title">Seleccionar Relator para Generar R17</h4>
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("GenerarPdfR17", "Comercializacions", FormMethod.Post, new { @id = "formR17" }))
                {
                    @Html.AntiForgeryToken()

                    <input type="hidden" name="id" id="idComercializacionR17" />
                    <div class="form-group">
                        @Html.Label("idRelator", "Relator", htmlAttributes: new { @class = "control-label" })
                        <select name="id2" id="relatoresR17" class="form-control"></select>
                    </div>
                }
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6 text-left">
                        <button type="button" id="btnCerrarR17" class="btn btn-default" data-dissmiss="modal">Cancelar</button>
                    </div>
                    <div class="col-md-6">
                        <button type="submit" id="btnEnviarR17" class="btn btn-primary">Generar R17</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade draggable-modal modalx"
     id="modalR50"
     tabindex="-1"
     data-backdrop="static"
     data-keyboard="false"
     role="dialog"
     aria-labelledby="deleteLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">
                    <div class="col-md-10">
                        <h4 class="modal-title">Seleccionar Template para Generar R50</h4>
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-body">
                @using (Html.BeginForm("GenerarPdfR50", "Comercializacions", FormMethod.Get, new { @id = "formR50" }))
                {
                    @*@Html.AntiForgeryToken()*@
                    <input type="hidden" name="id" id="idComercializacionR50" />
                    <div class="form-group">
                        @Html.Label("nombre", "Template", htmlAttributes: new { @class = "control-label" })
                        <select name="id2" id="templates" class="form-control"></select>
                    </div>
                }
            </div>
            <div class="modal-footer">
                <div class="row">
                    <div class="col-md-6 text-left">
                        <button type="button" id="btnCerrarR50" class="btn btn-default" data-dissmiss="modal">Cancelar</button>
                    </div>
                    <div class="col-md-6">
                        <button type="submit" id="btnEnviarR50" class="btn btn-primary">Generar R50</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade draggable-modal modalx"
     id="modalR24"
     tabindex="-1"
     data-backdrop="static"
     data-keyboard="false"
     role="dialog"
     aria-labelledby="deleteLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <div class="row">
                    <div class="col-md-10">
                        <h4 class="modal-title">Seleccionar Datos para generar el R24</h4>
                    </div>
                    <div class="col-md-2">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                </div>
            </div>
            @using (Html.BeginForm("GenerarPdfR24", "Comercializacions", FormMethod.Get, new { @id = "formR24" }))
            {
                <div class="modal-body">
                    @*@Html.AntiForgeryToken()*@
                    <input type="hidden" name="id" id="idComercializacionR24" />
                    <div class="form-group">
                        @Html.Label("nombre", "Filtro", htmlAttributes: new { @class = "control-label" })
                        <select name="type" class="form-control">
                            <option value="all">Todos</option>
                            <option value="sence">Sence</option>
                            <option value="nosence">No Sence</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <div class="row">
                        <div class="col-md-6 text-left">
                            <button type="button" id="btnCerrarR24" class="btn btn-default" data-dissmiss="modal">Cancelar</button>
                        </div>
                        <div class="col-md-6">
                            <button type="submit" id="btnEnviarR24" class="btn btn-primary">Generar R24</button>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
</div>

@section Scripts{
    <script>
        function Clipboard(id) {
            var $temp = $("<textarea>");
            var brRegex = /<br\s*[\/]?>/gi;
            $("body").append($temp);
            $temp.val($("#" + id).html().replace(brRegex, "\r\n")).select();
            document.execCommand("copy");
            $temp.remove();
        }

    </script>
    <script>
        var ep = false;
        var eps = false;
        var t = false;
        var ts = false;
        var te = "";
        var es = "";
        $(".filter").on("change", function () {
            te = $("#te").val();
            es = $("#es").val();
            var id = this.id;
            ep = false;
            eps = false;
            t = false;
            ts = false;
            var value = $('#' + this.id)[0].checked;
            $(".filter").each(function () {
                if (this.id != id) {
                    $('#' + this.id).prop('checked', false);
                }

            });
            if (id == "ep") {
                ep = value;
            }

            else if (id == "eps") {
                eps = value;
            }
            else if (id == "t") {
                t = value;
            }
            else if (id == "ts") {
                ts = value;
            }
            $("#sys-table-comercializacion").DataTable().destroy();
            CreateTable();
        });


        $(document).ready(function () {
            CreateTable();
            $(".filter").each(function () {
                $('#uniform-' + this.id).removeClass("checker");
            });
        });

        $('#btnCerrar').click(function () {
            $('#modalDiploma').modal('hide');
        });
        $('#btnEnviar').click(function () {
            $('#modalDiploma').modal('hide');
            $('#form').submit();
        });
        $('#btnEnviarUno').click(function () {
            $('#modalDiplomaUno').modal('hide');
            $('#formUno').submit();
        });
        $('#btnCerrarR17').click(function () {
            $('#modalR17').modal('hide');
        });
        $('#btnEnviarR17').click(function () {
            $('#modalR17').modal('hide');
            $('#formR17').submit();
        });
        $('#btnCerrarR50').click(function () {
            $('#modalR50').modal('hide');
        });
        $('#btnEnviarR50').click(function () {
            $('#modalR50').modal('hide');
            $('#formR50').submit();
        });
        $('#btnUnR23').click(function () {
            $('#unR23').show();
            $('#todosR23').hide();
            $('#btnEnviarUno').show();
            $('#btnEnviar').hide();
            $('#btnTodosR23').show();
            $('#btnUnR23').hide();
        });
        $('#btnTodosR23').click(function () {
            $('#todosR23').show();
            $('#unR23').hide();
            $('#btnEnviar').show();
            $('#btnEnviarUno').hide();
            $('#btnUnR23').show();
            $('#btnTodosR23').hide();
        });

        $('#btnCerrarNode').click(function () {
            cerrarNode();
        });




        //old
        function CreateTable() {
             var columnArray = [];
            var form = $('#form-ModalParticipanteCliente');
            var url = form.attr('action');
            var action = '@action';
            if (action == "IndexPostCurso") {
                columnArray = [
                    { "data": "codigoCotizacion" },
                    { "data": "curso" },
                    { "data": "cliente" },
                    { "data": "fecha" },

                    { "data": "tipoEjecucion" },
                    { "data": "estado" },
                    { "data": "comercial" },

                    { "data": "postCurso" },
                    { "data": "totalPorcent" },

                    { "data": "menu" },

                ]
            } else {
                columnArray = [
                    { "data": "codigoCotizacion" },
                    { "data": "curso" },
                    { "data": "cliente" },
                    { "data": "fechaInicio" },
                    { "data": "fechaTermino" },
                    { "data": "tipoEjecucion" },
                    { "data": "estado" },
                    { "data": "comercial" },



                    { "data": "menu" },

                ]
            }



            var table = $("#sys-table-comercializacion").DataTable({
                destroy: true,
                autoWidth: false,
                responsive: true,
                "bLengthChange": false,
                processing: true,

                serverSide: true,
                order: [0, "asc"],
                language: { processing: "Cargando...Por favor espere" },
                ajax: {
                    method: "POST",
                    url: url,
                    dataType: "json",
                    data: { view: action },
                    data: {
                        view: action
                        , ep: ep
                        , eps: eps
                        , t: t
                        , ts: ts
                        , te: te
                        , es: es
                    },
                    error: function (request, status, error) {
                        alert(request.responseText);
                    },
                },
                columns: columnArray
            });
            $('#sys-table-comercializacion_filter input').unbind();
            $('#sys-table-comercializacion_filter input').bind('keyup', function (e) {
                if (e.keyCode == 13) {
                    table.search(this.value).draw();

                }
            });
        }

        function mostrarModalDiploma(idComercializacion, tipoEjecucion, relatores, participantes) {
            $('#idComercializacionR23').val(idComercializacion);
            $('#relatores').empty();
            $('#relatoresUno').empty();

            relatores = relatores.replace(/&quot;/g, '"');
            relatores = JSON.parse(relatores);

            if (tipoEjecucion == "Elearning_Asincrono" || tipoEjecucion == "Recertificacion_Asincronica") {
                $('#relatores').append('<option value="0">Sin Relator</option>');
                $('#relatoresUno').append('<option value="0">Sin Relator</option>');
            }
            
            relatores.forEach(function (e) {
                $('#relatores').append('<option value="' + e.Value + '">' + e.Text + '</option>');
                $('#relatoresUno').append('<option value="' + e.Value + '">' + e.Text + '</option>');
            });
            $('#participantesR23').empty();

            participantes = participantes.replace(/&quot;/g, '"');
            participantes = JSON.parse(participantes)

            participantes.forEach(function (e) {
                $('#participantesR23').append('<option value="' + e.Value + '">' + e.Text + '</option>');
            });

            $('#modalDiploma').modal({ keyboard: true }, 'show');
        }
        function mostrarR17(idComercializacion, relatores) {
            $('#idComercializacionR17').val(idComercializacion);
            $('#relatoresR17').empty();

            relatores = relatores.replace(/&quot;/g, '"');
            relatores = JSON.parse(relatores)

            relatores.forEach(function (e) {
                $('#relatoresR17').append('<option value="' + e.Value + '">' + e.Text + '</option>');
            });
            $('#modalR17').modal({ keyboard: true }, 'show');
        }
        function mostrarR50(idComercializacion, templates) {
            $('#idComercializacionR50').val(idComercializacion);
            $('#templates').empty();

            templates = templates.replace(/&quot;/g, '"');
            templates = JSON.parse(templates)

            templates.forEach(function (e) {
                $('#templates').append('<option value="' + e.Value + '">' + e.Text + '</option>');
            });
            $('#modalR50').modal({ keyboard: true }, 'show');
        }
        function mostrarR24(idComercializacion) {
            $('#idComercializacionR24').val(idComercializacion);
            $('#modalR24').modal({ keyboard: true }, 'show');
        }
        function ShowModalCancelar(id) {
            $('#idComercializacionCancelar').val(id);
            $('#modal-cancelar').modal({ keyboard: true }, 'show');
        }
        function ShowModalTerminarSence(id) {
            $('#idComercializacionTerminarSence').val(id);
            $('#modal-terminar-sence').modal({ keyboard: true }, 'show');
        }
        function ShowModalTerminar(id) {
            $('#idComercializacionTerminar').val(id);
            $('#modal-terminar').modal({ keyboard: true }, 'show');
        }

    </script>
}
